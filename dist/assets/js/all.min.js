function buildColumn(e){if(html="",tmp=e.split("_"),columnNumber=parseInt(tmp[0],10)-1,tmpColumn!=columnNumber){tmpColumn=columnNumber;var i=$(window).innerHeight()+$(window).scrollTop();return $("#gallery").css("height",columnHeight[columnNumber]),$(".images").remove(),jQuery.each(requestResult[e],function(e,t){return"object"!=typeof t||null===t?!1:void(t.posY<=i?html+='<a class="images" href="'+t.imgPath+'" title="'+t.imgName+'"><img class="images" style="position:absolute; top:'+t.posY+"px; left:"+t.posX+"px; height:"+t.height+"px; width:"+t.width+'px; visibility:visible; " src="'+t.thumbPath+'" height="'+t.height+'" width="'+t.width+'"></a>':t.posY<=i+300&&t.posY<=i+900&&(html+='<a class="images" href="'+t.imgPath+'" title="'+t.imgName+'"><img class="images" style="position:absolute; top:'+t.posY+"px; left:"+t.posX+"px; height:"+t.height+"px; width:"+t.width+'px; visibility:hidden; " src="'+t.thumbPath+'" height="'+t.height+'" width="'+t.width+'"></a>'))}),void $("#gallery").append(html)}}function addImgToColumn(e,i){html="",jQuery.each(requestResult[e],function(e,t){if("object"==typeof t&&null!==t&&t.id>imgId&&t.id-imgId<=1)if("1_Columns"==activeColumn&&t.posY<=i+300)html+='<a class="images" href="'+t.imgPath+'" title="'+t.imgName+'"><img class="images" style="position:absolute; top:'+t.posY+"px; left:"+t.posX+"px; height:"+t.height+"px; width:"+t.width+'px; visibility:hidden; " src="'+t.thumbPath+'" height="'+t.height+'" width="'+t.width+'"></a>',imgId=t.id;else{if(!(t.posY<=i+900))return;html+='<a class="images" href="'+t.imgPath+'" title="'+t.imgName+'"><img class="images" style="position:absolute; top:'+t.posY+"px; left:"+t.posX+"px; height:"+t.height+"px; width:"+t.width+'px; visibility:hidden; " src="'+t.thumbPath+'" height="'+t.height+'" width="'+t.width+'"></a>',imgId=t.id}}),$("#gallery").append(html)}function refreshScreenOnScroll(e){var i=innerWinHeight+$(window).scrollTop();$(".images").each(function(){var t=parseInt($(this).css("top"),10),s=$(this).css("visibility");i-e>=t&&"NaN"!=t&&"hidden"==s&&("yes"==fadeIn?$(this).css({opacity:0,visibility:"visible"}).animate({opacity:1}):$(this).css("visibility","visible"),scrollPosSave=i)})}function refreshScreen(){var e=innerWinHeight+$(window).scrollTop();$(".images").each(function(){var i=parseInt($(this).css("top"),10);e>=i&&"NaN"!=i&&($(this).css("visibility","visible"),scrollPosSave=e)})}var requestResult="",hasColumns=-1,columns=0,names="",resize="",fadeIn="",columnHeight="";$.ajax({url:"php/Gallery.php",type:"post",data:{width:$(window).width(),galleryWidth:$(".popup-gallery").innerWidth()},cache:!1,beforeSend:function(){$(".ajax-loading").css("display","block")},success:function(e){{var i=$(window).width();$(window).height()}requestResult=e,columns=requestResult.numOfColumns,queries=requestResult.mediaQueries,names=requestResult.columnNames,resize=requestResult.resize,fadeIn=requestResult.fadeIn,columnHeight=requestResult.columnHeight,activeColumn=requestResult.activeColumn+"_Columns";for(var t=0;columns>t;t++)0===t?(buildColumn(names[t]),$(".ajax-loading").css("display","none"),refreshScreen()):i>=queries[t]&&(buildColumn(activeColumn),$(".ajax-loading").css("display","none"),refreshScreen())},error:function(e){console.log("Ajax Error: "+e)}});var tmpColumn=-1,imgId=0;$(function(){$(window).resize(function(){{var e=$(window).width();$(window).height()}if("yes"==resize){if(console.log(e+">= ? "+queries[queries.length-1]),e<=queries[0])return console.log("first col"),buildColumn(names[0]),void refreshScreen();if(e>=queries[queries.length-1])return buildColumn(names[columns-1]),console.log("last col"),void refreshScreen();if(e>=queries[0])for(var i=0;columns-1>=i;i++)if(e<=queries[i])return buildColumn(names[i-1]),void refreshScreen()}})});var scrollPosSave=0,scrollEvents=0,innerWinHeight=$(window).innerHeight(),scrollHeight=innerWinHeight,isInit=!1,winWidth=$(window).innerWidth(),timeoutId=0;jQuery(document).ready(function(e){e(window).scroll(function(){var i=innerWinHeight+e(window).scrollTop();i>scrollPosSave&&(scrollEvents++,winWidth>631||isInit===!1?(isInit=!0,refreshScreenOnScroll(100)):(631>winWidth||isInit===!1)&&(scrollEvents=0,isInit=!0,refreshScreenOnScroll(30)),timeoutId&&clearTimeout(timeoutId),timeoutId=setTimeout(function(){addImgToColumn(names[tmpColumn],i),refreshScreenOnScroll(30)},50))})}),$(function(){$(window).resize(function(){winWidth=$(window).innerWidth()})});